<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TonAudit AI â€” TON Smart Contract Security Auditor</title>
<style>
/* â”€â”€ Reset & tokens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
:root {
  --bg:       #0a0b0f;
  --surface:  #13151f;
  --surface2: #1a1d2e;
  --border:   #252840;
  --border2:  #2e3154;
  --accent:   #4f7fff;
  --accent2:  #7b5ea7;
  --text:     #e4e6f0;
  --muted:    #6b7298;
  --dim:      #3d4166;
  --critical: #ff4d6a;
  --high:     #ff7d3b;
  --medium:   #f5c542;
  --low:      #4ade80;
  --info:     #60c4ff;
  --r:        10px;
  --font:     'Inter', system-ui, -apple-system, sans-serif;
  --mono:     'JetBrains Mono', 'Fira Code', monospace;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  background: var(--bg); color: var(--text);
  font-family: var(--font); min-height: 100vh;
  display: flex; flex-direction: column;
  -webkit-font-smoothing: antialiased;
}
a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }

/* â”€â”€ Nav â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
nav {
  position: sticky; top: 0; z-index: 100;
  background: rgba(10,11,15,.92); backdrop-filter: blur(14px);
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; gap: 16px;
  padding: 0 24px; height: 56px;
}
.logo { display: flex; align-items: center; gap: 9px; }
.logo-mark {
  width: 32px; height: 32px; border-radius: 8px; flex-shrink: 0;
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent2) 100%);
  display: flex; align-items: center; justify-content: center;
  font-size: 15px;
}
.logo-name { font-size: 15px; font-weight: 700; letter-spacing: -.3px; }
.logo-name em { color: var(--accent); font-style: normal; }
.nav-sep { flex: 1; }
.nav-links { display: flex; align-items: center; gap: 20px; }
.nav-links a { font-size: 13px; color: var(--muted); transition: color .15s; }
.nav-links a:hover { color: var(--text); text-decoration: none; }
.nav-badge {
  font-size: 11px; padding: 3px 9px; border-radius: 20px;
  background: rgba(79,127,255,.12); border: 1px solid rgba(79,127,255,.3);
  color: var(--accent); white-space: nowrap;
}

/* â”€â”€ Hero â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero {
  text-align: center; padding: 64px 24px 48px;
  background: radial-gradient(ellipse 900px 360px at 50% 0, rgba(79,127,255,.07) 0%, transparent 70%);
}
.hero-pill {
  display: inline-flex; align-items: center; gap: 6px;
  font-size: 11px; letter-spacing: .07em; text-transform: uppercase;
  padding: 4px 12px; border-radius: 20px; margin-bottom: 24px;
  background: rgba(79,127,255,.1); border: 1px solid rgba(79,127,255,.25); color: var(--accent);
}
.hero h1 {
  font-size: clamp(26px, 5vw, 46px); font-weight: 800; letter-spacing: -.8px;
  line-height: 1.13; margin-bottom: 18px;
}
.hero h1 .grad {
  background: linear-gradient(135deg, var(--accent) 0%, #a78fff 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.hero p { font-size: 15px; color: var(--muted); max-width: 520px; margin: 0 auto 36px; line-height: 1.75; }
.hero-chips { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-bottom: 44px; }
.chip {
  font-size: 12px; padding: 5px 13px; border-radius: 20px;
  background: var(--surface); border: 1px solid var(--border); color: var(--muted);
}

/* â”€â”€ Workspace â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.workspace {
  flex: 1; display: grid;
  grid-template-columns: 220px 1fr 440px;
  max-width: 1380px; width: 100%; margin: 0 auto;
  border-top: 1px solid var(--border);
}

/* â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sidebar {
  border-right: 1px solid var(--border);
  padding: 20px 14px;
  position: sticky; top: 56px;
  height: calc(100vh - 56px); overflow-y: auto;
}
.sidebar::-webkit-scrollbar { width: 3px; }
.sidebar::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }
.sb-section { margin-bottom: 24px; }
.sb-title {
  font-size: 10px; letter-spacing: .1em; text-transform: uppercase;
  color: var(--dim); padding: 0 8px; margin-bottom: 8px;
}
.sample-btn {
  width: 100%; display: flex; align-items: center; gap: 8px;
  padding: 7px 8px; border-radius: 6px; cursor: pointer; border: none; background: none;
  text-align: left; transition: background .13s; color: var(--muted); font-size: 12px;
  font-family: var(--font);
}
.sample-btn:hover { background: var(--surface2); color: var(--text); }
.sample-btn.active { background: rgba(79,127,255,.12); color: var(--accent); }
.sample-ic { font-size: 13px; flex-shrink: 0; }
.sample-meta { flex: 1; min-width: 0; }
.sample-name { font-weight: 500; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
.sample-loc { font-size: 10px; color: var(--dim); margin-top: 1px; }
.cov-list { padding: 0 8px; }
.cov-item { font-size: 11px; color: var(--muted); line-height: 2; }
.cov-item::before { content: "âœ“ "; color: var(--low); }

/* â”€â”€ Editor pane â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.editor-pane {
  border-right: 1px solid var(--border);
  padding: 24px 28px; display: flex; flex-direction: column; gap: 14px;
}
.pane-header { display: flex; align-items: center; gap: 10px; }
.pane-title { font-size: 14px; font-weight: 600; }
.pane-sub { font-size: 12px; color: var(--muted); margin-left: auto; }
.tabs {
  display: flex; gap: 3px;
  background: var(--surface); border-radius: 8px; padding: 3px; width: fit-content;
}
.tab-btn {
  padding: 5px 14px; border-radius: 6px; font-size: 12px;
  cursor: pointer; transition: all .13s; color: var(--muted);
  border: none; background: none; font-family: var(--font);
}
.tab-btn.active { background: var(--surface2); color: var(--text); }

/* Code textarea */
#code-input {
  flex: 1; min-height: 340px; max-height: 480px;
  background: var(--surface); border: 1px solid var(--border); border-radius: var(--r);
  color: var(--text); font-family: var(--mono); font-size: 12.5px; line-height: 1.65;
  padding: 14px 16px; resize: vertical; outline: none; tab-size: 2;
  transition: border-color .15s;
}
#code-input:focus { border-color: var(--accent); }
#code-input::placeholder { color: var(--dim); }

/* Drop zone */
.drop-zone {
  border: 2px dashed var(--border2); border-radius: var(--r);
  padding: 40px 24px; text-align: center; cursor: pointer;
  transition: all .15s; display: none;
}
.drop-zone.show { display: block; }
.drop-zone:hover, .drop-zone.drag { border-color: var(--accent); background: rgba(79,127,255,.05); }
.drop-icon { font-size: 36px; margin-bottom: 10px; }
.drop-text { font-size: 14px; color: var(--muted); }
.drop-sub { font-size: 11px; color: var(--dim); margin-top: 4px; }
#file-input { display: none; }

/* File chip */
.file-chip {
  display: none; align-items: center; gap: 8px;
  padding: 7px 12px; background: var(--surface); border: 1px solid var(--border);
  border-radius: 6px; font-size: 12px; color: var(--muted);
}
.file-chip.show { display: flex; }
.file-chip-x { margin-left: auto; cursor: pointer; color: var(--dim); transition: color .13s; }
.file-chip-x:hover { color: var(--critical); }

/* Audit button */
.audit-btn {
  display: flex; align-items: center; justify-content: center; gap: 8px;
  padding: 13px; border-radius: var(--r); border: none; cursor: pointer;
  background: linear-gradient(135deg, var(--accent) 0%, #6a5acd 100%);
  color: #fff; font-size: 14px; font-weight: 600; letter-spacing: .01em;
  transition: opacity .2s, transform .15s, box-shadow .2s;
  font-family: var(--font);
}
.audit-btn:hover:not(:disabled) {
  opacity: .9; transform: translateY(-1px);
  box-shadow: 0 8px 24px rgba(79,127,255,.35);
}
.audit-btn:disabled { opacity: .45; cursor: not-allowed; transform: none; box-shadow: none; }
.spin {
  width: 15px; height: 15px;
  border: 2px solid rgba(255,255,255,.35); border-top-color: #fff;
  border-radius: 50%; animation: spin .75s linear infinite; display: none;
}
@keyframes spin { to { transform: rotate(360deg); } }
.audit-btn.busy .spin { display: block; }

/* Status bar */
.status-bar {
  display: none; align-items: center; gap: 8px;
  padding: 9px 13px; background: var(--surface); border-radius: 6px;
  font-size: 12px; color: var(--muted);
}
.status-bar.show { display: flex; }
.pulse {
  width: 6px; height: 6px; border-radius: 50%; background: var(--accent); flex-shrink: 0;
  animation: pulse 1.1s ease-in-out infinite;
}
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.35} }

/* â”€â”€ Report pane â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.report-pane {
  padding: 24px 22px; overflow-y: auto;
  position: sticky; top: 56px; height: calc(100vh - 56px);
}
.report-pane::-webkit-scrollbar { width: 3px; }
.report-pane::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }

.rp-empty {
  height: 100%; display: flex; flex-direction: column;
  align-items: center; justify-content: center; text-align: center; gap: 12px;
  color: var(--dim); padding: 32px;
}
.rp-empty-icon { font-size: 52px; opacity: .5; }
.rp-empty p { font-size: 13px; line-height: 1.7; max-width: 260px; }

/* Score card */
.score-card {
  display: flex; align-items: center; gap: 18px;
  padding: 18px; background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--r); margin-bottom: 14px;
}
.ring-wrap { position: relative; flex-shrink: 0; }
.ring-num {
  position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
  font-size: 20px; font-weight: 800;
}
.score-info h3 { font-size: 15px; font-weight: 700; margin-bottom: 6px; }
.score-info p { font-size: 12px; color: var(--muted); line-height: 1.6; }

/* Risk badge */
.risk-badge {
  display: inline-flex; align-items: center; gap: 4px;
  padding: 3px 9px; border-radius: 20px;
  font-size: 11px; font-weight: 700; letter-spacing: .06em; text-transform: uppercase;
}
.r-critical { background: rgba(255,77,106,.14); color: var(--critical); border: 1px solid rgba(255,77,106,.3); }
.r-high     { background: rgba(255,125,59,.14);  color: var(--high);     border: 1px solid rgba(255,125,59,.3); }
.r-medium   { background: rgba(245,197,66,.14);  color: var(--medium);   border: 1px solid rgba(245,197,66,.3); }
.r-low, .r-clean { background: rgba(74,222,128,.14); color: var(--low);  border: 1px solid rgba(74,222,128,.3); }

/* Meta grid */
.meta-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 14px; }
.meta-card { padding: 11px 13px; background: var(--surface); border: 1px solid var(--border); border-radius: 8px; }
.meta-lbl { font-size: 10px; color: var(--dim); text-transform: uppercase; letter-spacing: .06em; }
.meta-val { font-size: 13px; font-weight: 600; margin-top: 3px; }

/* PDF / export button */
.export-btn {
  width: 100%; display: flex; align-items: center; justify-content: center; gap: 7px;
  padding: 10px; border-radius: 8px; border: 1px solid var(--border);
  background: var(--surface); color: var(--muted); font-size: 13px; font-weight: 500;
  cursor: pointer; transition: all .15s; margin-bottom: 16px; font-family: var(--font);
}
.export-btn:hover { border-color: var(--accent); color: var(--text); }

/* Section headers */
.sec-hdr { display: flex; align-items: center; justify-content: space-between; margin: 18px 0 10px; }
.sec-title { font-size: 13px; font-weight: 600; }
.sec-count { font-size: 11px; color: var(--muted); padding: 2px 8px; background: var(--surface); border-radius: 20px; }

/* Finding cards */
.finding {
  border: 1px solid var(--border); border-radius: var(--r);
  margin-bottom: 8px; overflow: hidden;
}
.finding-hdr {
  padding: 11px 13px; display: flex; align-items: center; gap: 9px;
  background: var(--surface); cursor: pointer; user-select: none;
  transition: background .13s;
}
.finding-hdr:hover { background: var(--surface2); }
.sev-dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
.d-critical { background: var(--critical); box-shadow: 0 0 7px var(--critical); }
.d-high     { background: var(--high);     box-shadow: 0 0 7px var(--high); }
.d-medium   { background: var(--medium); }
.d-low      { background: var(--low); }
.d-info     { background: var(--info); }
.finding-title { font-size: 12.5px; font-weight: 600; flex: 1; line-height: 1.35; }
.finding-id { font-size: 10px; color: var(--dim); font-family: var(--mono); flex-shrink: 0; }
.finding-chev { font-size: 9px; color: var(--dim); flex-shrink: 0; transition: transform .2s; }
.finding.open .finding-chev { transform: rotate(180deg); }

.finding-body {
  display: none; padding: 13px 14px; border-top: 1px solid var(--border);
  background: var(--surface2); font-size: 12px; line-height: 1.65;
}
.finding.open .finding-body { display: block; }
.fb-row { margin-bottom: 9px; }
.fb-lbl { font-size: 9px; color: var(--dim); text-transform: uppercase; letter-spacing: .07em; margin-bottom: 3px; }
.fb-val { color: var(--muted); }
.fb-loc { color: var(--info); font-family: var(--mono); font-size: 11px; }
.fb-rec { color: var(--low); }
.code-snip {
  background: var(--bg); border: 1px solid var(--border); border-radius: 5px;
  padding: 8px 10px; font-family: var(--mono); font-size: 11px; color: #a8b4ff;
  white-space: pre-wrap; word-break: break-all; margin-top: 3px;
  overflow-x: auto;
}

/* Analysis cards */
.analysis-card {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--r); padding: 13px; margin-bottom: 8px;
}
.analysis-card h4 { font-size: 12px; font-weight: 600; margin-bottom: 7px; display: flex; align-items: center; gap: 6px; }
.analysis-card p { font-size: 12px; color: var(--muted); line-height: 1.7; }

/* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
footer {
  border-top: 1px solid var(--border);
  padding: 18px 24px; text-align: center;
  font-size: 11px; color: var(--dim);
  display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 6px;
}
.ft-sep { color: var(--border2); }

/* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 1100px) {
  .workspace { grid-template-columns: 0 1fr 380px; }
  .sidebar { display: none; }
}
@media (max-width: 720px) {
  .workspace { grid-template-columns: 1fr; display: flex; flex-direction: column; }
  .editor-pane { border-right: none; border-bottom: 1px solid var(--border); }
  .report-pane { position: static; height: auto; }
  .nav-links { display: none; }
}
</style>
</head>
<body>

<!-- â”€â”€ Nav â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<nav>
  <div class="logo">
    <div class="logo-mark">ğŸ”</div>
    <span class="logo-name">Ton<em>Audit</em> AI</span>
  </div>
  <div class="nav-sep"></div>
  <div class="nav-links">
    <a href="#workspace">Audit</a>
    <a href="https://github.com/ripgtxgt/ton-audit-ai" target="_blank" rel="noopener">GitHub â†—</a>
    <a href="https://ton.org" target="_blank" rel="noopener">TON â†—</a>
  </div>
  <span class="nav-badge">Claude Opus Â· TokenTon26</span>
</nav>

<!-- â”€â”€ Hero â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<section class="hero">
  <div class="hero-pill">
    <span>âš¡</span> TON Blockchain Security Â· AI-Powered
  </div>
  <h1>Smart Contract<br><span class="grad">Security Auditor</span></h1>
  <p>
    Paste your FunC or Tact contract. Get a structured security report covering
    15+ vulnerability categories â€” specific to TON's async message model and TVM.
  </p>
  <div class="hero-chips">
    <span class="chip">FunC &amp; Tact</span>
    <span class="chip">15+ Vuln Categories</span>
    <span class="chip">Bounce Handler Checks</span>
    <span class="chip">TEP-74 / TEP-62 Compliance</span>
    <span class="chip">Gas Analysis</span>
    <span class="chip">&lt; 30s Audit Time</span>
  </div>
</section>

<!-- â”€â”€ Workspace â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="workspace" id="workspace">

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sb-section">
      <div class="sb-title">Sample Contracts</div>
      <div id="sample-list"><div style="font-size:11px;color:var(--dim);padding:8px">Loadingâ€¦</div></div>
    </div>
    <div class="sb-section">
      <div class="sb-title">Vulnerability Coverage</div>
      <div class="cov-list">
        <div class="cov-item">Reentrancy (async chains)</div>
        <div class="cov-item">Bounce handler missing</div>
        <div class="cov-item">Sender / access control</div>
        <div class="cov-item">Integer overflow</div>
        <div class="cov-item">Storage exhaustion</div>
        <div class="cov-item">Gas griefing</div>
        <div class="cov-item">TEP-74 Jetton compliance</div>
        <div class="cov-item">TEP-62 NFT compliance</div>
        <div class="cov-item">Send mode errors</div>
        <div class="cov-item">State management</div>
      </div>
    </div>
  </aside>

  <!-- Editor -->
  <div class="editor-pane">
    <div class="pane-header">
      <span class="pane-title">Contract Input</span>
      <span class="pane-sub">FunC (.fc) or Tact (.tact)</span>
    </div>

    <div class="tabs">
      <button class="tab-btn active" onclick="setTab('paste')">ğŸ“ Paste Code</button>
      <button class="tab-btn"        onclick="setTab('upload')">ğŸ“ Upload File</button>
      <button class="tab-btn"        onclick="setTab('batch')">ğŸ“¦ Batch Audit</button>
    </div>

    <textarea id="code-input"
      spellcheck="false" autocomplete="off"
      placeholder=";; Paste your FunC or Tact contract hereâ€¦
;;
;; Example:
() recv_internal(int msg_value, cell in_msg_full, slice in_msg_body) impure {
    ;; contract logic
}"></textarea>

    <div class="drop-zone" id="drop-zone"
         ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="drop(event)"
         onclick="document.getElementById('file-input').click()">
      <div class="drop-icon">ğŸ“„</div>
      <div class="drop-text">Drop .fc or .tact file here</div>
      <div class="drop-sub">or click to browse</div>
    </div>
    <input type="file" id="file-input" accept=".fc,.func,.tact" onchange="fileSelected(event)">

    <!-- Batch mode -->
    <div id="batch-zone" style="display:none">
      <div class="drop-zone show" id="batch-drop"
           ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="batchDrop(event)"
           onclick="document.getElementById('batch-input').click()"
           style="margin-bottom:10px">
        <div class="drop-icon">ğŸ“¦</div>
        <div class="drop-text">Drop 2â€“10 contract files for batch analysis</div>
        <div class="drop-sub">.fc and .tact â€” get a comparison report across all contracts</div>
      </div>
      <input type="file" id="batch-input" accept=".fc,.func,.tact" multiple onchange="batchSelected(event)">
      <div id="batch-file-list" style="display:none;margin-bottom:8px"></div>
    </div>

    <div class="file-chip" id="file-chip">
      <span>ğŸ“„</span>
      <span id="file-chip-name">â€”</span>
      <span class="file-chip-x" onclick="clearFile()">âœ•</span>
    </div>

    <button class="audit-btn" id="audit-btn" onclick="tab==='batch' ? runBatch() : runAudit()">
      <div class="spin"></div>
      <span id="btn-txt">ğŸ” Run Security Audit</span>
    </button>

    <div class="status-bar" id="status-bar">
      <div class="pulse"></div>
      <span id="status-txt">Initializingâ€¦</span>
    </div>
  </div>

  <!-- Report -->
  <div class="report-pane">
    <div class="rp-empty" id="rp-empty">
      <div class="rp-empty-icon">ğŸ›¡ï¸</div>
      <p>Paste a FunC or Tact contract on the left, then click <strong>Run Security Audit</strong>.</p>
      <p style="font-size:11px;opacity:.6;margin-top:8px">Powered by Claude Opus Â· Built for TokenTon26</p>
    </div>
    <div id="rp-content" style="display:none"></div>
  </div>

</div>

<!-- â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<footer>
  <span>ğŸ” TonAudit AI</span>
  <span class="ft-sep">Â·</span>
  <a href="https://github.com/ripgtxgt/ton-audit-ai" target="_blank" rel="noopener">github.com/ripgtxgt/ton-audit-ai</a>
  <span class="ft-sep">Â·</span>
  <span>Built for <strong>TokenTon26 Hackathon</strong></span>
  <span class="ft-sep">Â·</span>
  <span>Powered by Anthropic Claude</span>
</footer>

<script>
/* â”€â”€ Globals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let currentFile = null;
let lastReport  = null;
let tab = 'paste';

/* â”€â”€ Samples â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function loadSamples() {
  try {
    const r = await fetch('/api/samples');
    const { samples } = await r.json();
    const el = document.getElementById('sample-list');
    if (!samples?.length) { el.innerHTML = '<div style="font-size:11px;color:var(--dim);padding:8px">None</div>'; return; }
    el.innerHTML = samples.map(s => `
      <button class="sample-btn" id="sbtn-${s.name}" onclick="loadSample('${s.name}')">
        <span class="sample-ic">${s.name.endsWith('.tact') ? 'ğŸŸ£' : 'ğŸ”µ'}</span>
        <span class="sample-meta">
          <span class="sample-name">${s.name}</span>
          <span class="sample-loc">${s.lines} lines</span>
        </span>
      </button>`).join('');
  } catch {}
}

async function loadSample(name) {
  document.querySelectorAll('.sample-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('sbtn-' + name)?.classList.add('active');
  try {
    const r = await fetch('/api/samples/' + name);
    const { code } = await r.json();
    setTab('paste');
    document.getElementById('code-input').value = code;
    showFileChip(name);
    currentFile = { name };
  } catch {}
}

/* â”€â”€ Tab â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function setTab(t) {
  tab = t;
  document.querySelectorAll('.tab-btn').forEach((b, i) => {
    b.classList.toggle('active', (i===0&&t==='paste')||(i===1&&t==='upload')||(i===2&&t==='batch'));
  });
  document.getElementById('code-input').style.display = t === 'paste' ? 'block' : 'none';
  const dz = document.getElementById('drop-zone');
  if (t === 'upload') dz.classList.add('show'); else dz.classList.remove('show');
  document.getElementById('batch-zone').style.display = t === 'batch' ? 'block' : 'none';
  document.getElementById('btn-txt').textContent = t === 'batch' ? 'ğŸ“¦ Run Batch Audit' : 'ğŸ” Run Security Audit';
}

/* â”€â”€ File â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showFileChip(name) {
  document.getElementById('file-chip-name').textContent = name;
  document.getElementById('file-chip').classList.add('show');
}
function clearFile() {
  currentFile = null;
  document.getElementById('file-chip').classList.remove('show');
  document.getElementById('file-input').value = '';
  document.querySelectorAll('.sample-btn').forEach(b => b.classList.remove('active'));
}
function handleFile(file) {
  currentFile = file;
  showFileChip(file.name);
  const fr = new FileReader();
  fr.onload = e => { document.getElementById('code-input').value = e.target.result; setTab('paste'); };
  fr.readAsText(file);
}
function fileSelected(e) { if (e.target.files[0]) handleFile(e.target.files[0]); }
function dragOver(e)  { e.preventDefault(); e.currentTarget.classList.add('drag'); }
function dragLeave(e) { e.currentTarget.classList.remove('drag'); }
function drop(e)      { e.preventDefault(); e.currentTarget.classList.remove('drag'); if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]); }

/* â”€â”€ Audit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function runAudit() {
  const code = document.getElementById('code-input').value.trim();
  if (!code) { alert('Paste or upload a contract first.'); return; }

  const btn = document.getElementById('audit-btn');
  const statusBar = document.getElementById('status-bar');
  btn.disabled = true; btn.classList.add('busy');
  document.getElementById('btn-txt').textContent = 'Analyzingâ€¦';
  statusBar.classList.add('show');
  setStatus('ğŸ” Sending to Claudeâ€¦');

  document.getElementById('rp-empty').style.display = 'none';
  document.getElementById('rp-content').style.display = 'none';
  lastReport = null;

  const filename = currentFile?.name ?? 'contract.fc';

  try {
    const res = await fetch('/api/audit', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ code, filename }),
    });

    const reader = res.body.getReader();
    const dec = new TextDecoder();
    let buf = '';

    while (true) {
      const { done, value } = await reader.read();
      if (done) break;
      buf += dec.decode(value, { stream: true });
      const lines = buf.split('\n');
      buf = lines.pop();
      for (const line of lines) {
        if (!line.startsWith('data: ')) continue;
        const d = JSON.parse(line.slice(6));
        if (d.message) setStatus(d.message);
        if (d.contractName) { lastReport = d; renderReport(d); }
      }
    }
  } catch (err) {
    setStatus('âŒ ' + err.message);
  } finally {
    btn.disabled = false; btn.classList.remove('busy');
    document.getElementById('btn-txt').textContent = 'ğŸ” Run Security Audit';
    setTimeout(() => statusBar.classList.remove('show'), 2500);
  }
}

function setStatus(msg) { document.getElementById('status-txt').textContent = msg; }

/* â”€â”€ PDF export â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function downloadPDF() {
  if (!lastReport) return;
  const btn = document.getElementById('pdf-btn');
  if (btn) { btn.textContent = 'â³ Generating PDFâ€¦'; btn.disabled = true; }
  try {
    const res = await fetch('/api/report/pdf', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(lastReport),
    });
    if (!res.ok) throw new Error(await res.text());
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `tonaudit-${lastReport.contractName}.pdf`;
    document.body.appendChild(a); a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  } catch (err) {
    alert('PDF error: ' + err.message);
  } finally {
    if (btn) { btn.textContent = 'ğŸ“„ Download PDF Report'; btn.disabled = false; }
  }
}

/* â”€â”€ Render report â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function sevColor(s) {
  return { critical:'var(--critical)', high:'var(--high)', medium:'var(--medium)', low:'var(--low)', info:'var(--info)' }[s] || 'var(--muted)';
}
function esc(s) {
  if (!s) return '';
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

function renderReport(r) {
  const el = document.getElementById('rp-content');
  el.style.display = 'block';
  document.getElementById('rp-empty').style.display = 'none';

  // Score ring
  const score = r.score;
  const scoreColor = score >= 80 ? 'var(--low)' : score >= 60 ? 'var(--medium)' : score >= 40 ? 'var(--high)' : 'var(--critical)';
  const R = 34, C = 2 * Math.PI * R;
  const dash = C * score / 100;

  // Counts
  const cnt = {};
  r.findings.forEach(f => cnt[f.severity] = (cnt[f.severity]||0)+1);
  const auditTime = new Date(r.auditedAt).toLocaleString();
  const langLabel = r.language === 'func' ? 'FunC' : r.language === 'tact' ? 'Tact' : 'Unknown';

  el.innerHTML = `
    <!-- Score -->
    <div class="score-card">
      <div class="ring-wrap">
        <svg width="80" height="80" viewBox="0 0 80 80" style="transform:rotate(-90deg)">
          <circle cx="40" cy="40" r="${R}" fill="none" stroke="var(--surface2)" stroke-width="7"/>
          <circle cx="40" cy="40" r="${R}" fill="none" stroke="${scoreColor}" stroke-width="7"
            stroke-dasharray="${dash} ${C}" stroke-linecap="round" style="transition:stroke-dasharray 1.1s ease"/>
        </svg>
        <span class="ring-num" style="color:${scoreColor}">${score}</span>
      </div>
      <div class="score-info">
        <h3>${esc(r.contractName)}</h3>
        <span class="risk-badge r-${r.overallRisk}" style="margin-bottom:6px;display:inline-block">${r.overallRisk.toUpperCase()}</span>
        <p>${esc(r.summary)}</p>
      </div>
    </div>

    <!-- Meta -->
    <div class="meta-grid">
      <div class="meta-card"><div class="meta-lbl">Language</div><div class="meta-val">${langLabel}</div></div>
      <div class="meta-card"><div class="meta-lbl">Lines of Code</div><div class="meta-val">${r.linesOfCode}</div></div>
      <div class="meta-card"><div class="meta-lbl">Total Findings</div><div class="meta-val">${r.findings.length}</div></div>
      <div class="meta-card">
        <div class="meta-lbl">Critical / High</div>
        <div class="meta-val" style="color:${(cnt.critical||0)>0?'var(--critical)':(cnt.high||0)>0?'var(--high)':'var(--low)'}">
          ${cnt.critical||0} / ${cnt.high||0}
        </div>
      </div>
    </div>

    <!-- PDF export -->
    <button class="export-btn" id="pdf-btn" onclick="downloadPDF()">ğŸ“„ Download PDF Report</button>

    <!-- Findings -->
    <div class="sec-hdr">
      <span class="sec-title">ğŸ” Security Findings</span>
      <span class="sec-count">${r.findings.length} issues</span>
    </div>

    ${r.findings.length === 0 ? `
      <div class="analysis-card" style="text-align:center;padding:28px">
        <div style="font-size:36px;margin-bottom:8px">âœ…</div>
        <div style="font-weight:600;margin-bottom:4px">No issues found</div>
        <div style="font-size:12px;color:var(--muted)">This contract looks secure!</div>
      </div>` :
      r.findings.map((f, i) => `
      <div class="finding" id="f${i}">
        <div class="finding-hdr" onclick="toggleF(${i})">
          <div class="sev-dot d-${f.severity}"></div>
          <div class="finding-title">${esc(f.title)}</div>
          <div class="finding-id">${esc(f.id)}</div>
          <div class="finding-chev">â–¼</div>
        </div>
        <div class="finding-body">
          ${f.location ? `<div class="fb-row"><div class="fb-lbl">Location</div><div class="fb-loc">${esc(f.location)}</div></div>` : ''}
          <div class="fb-row"><div class="fb-lbl">Description</div><div class="fb-val">${esc(f.description)}</div></div>
          ${f.codeSnippet ? `<div class="fb-row"><div class="fb-lbl">Code</div><div class="code-snip">${esc(f.codeSnippet)}</div></div>` : ''}
          <div class="fb-row"><div class="fb-lbl">Recommendation</div><div class="fb-rec">${esc(f.recommendation)}</div></div>
        </div>
      </div>`).join('')}

    <!-- Analysis -->
    <div class="sec-hdr" style="margin-top:22px">
      <span class="sec-title">âš™ï¸ Analysis</span>
    </div>
    <div class="analysis-card">
      <h4>â›½ Gas Analysis</h4>
      <p>${esc(r.gasAnalysis)}</p>
    </div>
    <div class="analysis-card">
      <h4>ğŸ—ï¸ Architecture Notes</h4>
      <p>${esc(r.architectureNotes)}</p>
    </div>

    <div style="text-align:center;margin:20px 0 4px;font-size:10px;color:var(--dim)">
      Audited ${auditTime} Â· TonAudit AI v1.0 Â·
      <a href="https://github.com/ripgtxgt/ton-audit-ai" target="_blank" rel="noopener">github.com/ripgtxgt/ton-audit-ai</a>
    </div>`;

  // Auto-open first critical/high
  const first = r.findings.findIndex(f => f.severity === 'critical' || f.severity === 'high');
  if (first >= 0) toggleF(first);
  el.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function toggleF(i) { document.getElementById('f'+i)?.classList.toggle('open'); }

/* â”€â”€ Batch file handling â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let batchFiles = [];

function batchDrop(e) {
  e.preventDefault(); e.currentTarget.classList.remove('drag');
  addBatchFiles(Array.from(e.dataTransfer.files));
}
function batchSelected(e) { addBatchFiles(Array.from(e.target.files)); }

function addBatchFiles(newFiles) {
  const allowed = ['.fc', '.func', '.tact'];
  const valid = newFiles.filter(f => allowed.some(ext => f.name.toLowerCase().endsWith(ext)));
  batchFiles = [...batchFiles, ...valid].slice(0, 10); // max 10
  renderBatchFileList();
}

function removeBatchFile(i) {
  batchFiles.splice(i, 1);
  renderBatchFileList();
}

function renderBatchFileList() {
  const el = document.getElementById('batch-file-list');
  if (batchFiles.length === 0) { el.style.display = 'none'; return; }
  el.style.display = 'block';
  el.innerHTML = `
    <div style="font-size:11px;color:var(--muted);margin-bottom:6px">${batchFiles.length} file${batchFiles.length>1?'s':''} queued (max 10):</div>
    ${batchFiles.map((f,i) => `
      <div style="display:flex;align-items:center;gap:8px;padding:5px 8px;background:var(--surface);
                  border:1px solid var(--border);border-radius:6px;margin-bottom:4px;font-size:12px;">
        <span>${f.name.endsWith('.tact')?'ğŸŸ£':'ğŸ”µ'}</span>
        <span style="flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis">${f.name}</span>
        <span style="color:var(--dim);font-size:11px">${(f.size/1024).toFixed(1)}KB</span>
        <span style="cursor:pointer;color:var(--dim)" onclick="removeBatchFile(${i})">âœ•</span>
      </div>`).join('')}`;
}

/* â”€â”€ Batch audit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let lastBatchReport = null;

async function runBatch() {
  if (batchFiles.length < 2) { alert('Add at least 2 contract files for batch analysis.'); return; }

  const btn = document.getElementById('audit-btn');
  const statusBar = document.getElementById('status-bar');
  btn.disabled = true; btn.classList.add('busy');
  document.getElementById('btn-txt').textContent = 'Auditingâ€¦';
  statusBar.classList.add('show');
  setStatus(`ğŸ“¦ Starting batch audit of ${batchFiles.length} contractsâ€¦`);

  document.getElementById('rp-empty').style.display = 'none';
  document.getElementById('rp-content').style.display = 'none';
  lastBatchReport = null;

  const formData = new FormData();
  batchFiles.forEach(f => formData.append('contracts', f));

  try {
    const res = await fetch('/api/audit/batch', { method: 'POST', body: formData });
    const reader = res.body.getReader();
    const dec = new TextDecoder();
    let buf = '';

    while (true) {
      const { done, value } = await reader.read();
      if (done) break;
      buf += dec.decode(value, { stream: true });
      const lines = buf.split('\n');
      buf = lines.pop();
      for (const line of lines) {
        if (!line.startsWith('data: ')) continue;
        const d = JSON.parse(line.slice(6));
        if (d.message) setStatus(d.message);
        if (d.filename && d.score !== undefined) {
          setStatus(`âœ… ${d.filename} â€” score ${d.score}/100 (${d.risk})`);
        }
        if (d.reports) { lastBatchReport = d; renderBatchReport(d); }
      }
    }
  } catch(err) {
    setStatus('âŒ ' + err.message);
  } finally {
    btn.disabled = false; btn.classList.remove('busy');
    document.getElementById('btn-txt').textContent = 'ğŸ“¦ Run Batch Audit';
    setTimeout(() => statusBar.classList.remove('show'), 3000);
  }
}

/* â”€â”€ Batch report rendering â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function renderBatchReport(br) {
  const el = document.getElementById('rp-content');
  el.style.display = 'block';
  document.getElementById('rp-empty').style.display = 'none';
  const c = br.comparison;
  const auditTime = new Date(br.auditedAt).toLocaleString();

  const riskRankRows = c.riskRanking.map(r => {
    const scoreColor = r.score>=80?'var(--low)':r.score>=60?'var(--medium)':r.score>=40?'var(--high)':'var(--critical)';
    return `<tr>
      <td style="padding:8px 10px;font-size:12px;font-weight:600">${esc(r.contractName)}</td>
      <td style="padding:8px 10px;text-align:center">
        <span class="risk-badge r-${r.overallRisk}">${r.overallRisk.toUpperCase()}</span>
      </td>
      <td style="padding:8px 10px;text-align:center;font-size:14px;font-weight:700;color:${scoreColor}">${r.score}</td>
    </tr>`;
  }).join('');

  const catRows = c.commonCategories.map(cat => `
    <div style="display:flex;justify-content:space-between;align-items:center;
                padding:5px 0;border-bottom:1px solid var(--border);font-size:12px">
      <span style="color:var(--muted)">${esc(cat.category)}</span>
      <span style="font-weight:600;color:var(--high)">${cat.count} findings</span>
    </div>`).join('');

  // Per-contract mini cards
  const contractCards = br.reports.map((r, idx) => {
    const scoreColor = r.score>=80?'var(--low)':r.score>=60?'var(--medium)':r.score>=40?'var(--high)':'var(--critical)';
    const cnt = {};
    r.findings.forEach(f => cnt[f.severity]=(cnt[f.severity]||0)+1);
    return `
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:var(--r);
                padding:12px;margin-bottom:8px">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px">
        <span style="font-size:18px;font-weight:800;color:${scoreColor}">${r.score}</span>
        <div>
          <div style="font-size:13px;font-weight:600">${esc(r.contractName)}</div>
          <div style="font-size:11px;color:var(--muted)">${r.language.toUpperCase()} Â· ${r.linesOfCode} LoC</div>
        </div>
        <span class="risk-badge r-${r.overallRisk}" style="margin-left:auto">${r.overallRisk.toUpperCase()}</span>
      </div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px">
        ${['critical','high','medium','low'].filter(s=>cnt[s]).map(s=>`
          <span style="font-size:11px;padding:2px 7px;border-radius:20px;
                       background:rgba(0,0,0,0.3);color:${sevColor(s)};border:1px solid ${sevColor(s)}4d">
            ${cnt[s]} ${s}
          </span>`).join('')}
        ${r.findings.length===0?'<span style="font-size:11px;color:var(--low)">âœ… No issues</span>':''}
      </div>
      <div style="font-size:11px;color:var(--muted);line-height:1.5">${esc(r.summary.slice(0,140))}â€¦</div>
      <button onclick="showSingleFromBatch(${idx})"
        style="margin-top:8px;font-size:11px;padding:4px 10px;border-radius:6px;
               background:var(--surface2);border:1px solid var(--border);color:var(--muted);
               cursor:pointer;font-family:var(--font)">
        View full report â†’
      </button>
    </div>`;
  }).join('');

  el.innerHTML = `
    <!-- Batch header -->
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:var(--r);
                padding:16px;margin-bottom:14px">
      <div style="font-size:15px;font-weight:700;margin-bottom:4px">ğŸ“¦ Batch Audit Complete</div>
      <div style="font-size:12px;color:var(--muted)">${br.totalContracts} contracts Â· ${c.totalFindings} total findings Â· ${auditTime}</div>
    </div>

    <!-- Summary stats -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:14px">
      <div class="meta-card"><div class="meta-lbl">Total Findings</div><div class="meta-val">${c.totalFindings}</div></div>
      <div class="meta-card"><div class="meta-lbl">Critical / High</div>
        <div class="meta-val" style="color:${c.criticalCount>0?'var(--critical)':c.highCount>0?'var(--high)':'var(--low)'}">
          ${c.criticalCount} / ${c.highCount}
        </div>
      </div>
      <div class="meta-card">
        <div class="meta-lbl">Most Vulnerable</div>
        <div class="meta-val" style="font-size:11px;color:var(--critical)">${esc(c.mostVulnerable)}</div>
      </div>
      <div class="meta-card">
        <div class="meta-lbl">Safest Contract</div>
        <div class="meta-val" style="font-size:11px;color:var(--low)">${esc(c.safest)}</div>
      </div>
    </div>

    <!-- Risk ranking table -->
    <div class="sec-hdr"><span class="sec-title">ğŸ† Risk Ranking</span></div>
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:var(--r);
                overflow:hidden;margin-bottom:14px">
      <table style="width:100%;border-collapse:collapse">
        <thead>
          <tr style="background:var(--surface2);font-size:10px;color:var(--dim);text-transform:uppercase;letter-spacing:.06em">
            <th style="padding:8px 10px;text-align:left">Contract</th>
            <th style="padding:8px 10px;text-align:center">Risk</th>
            <th style="padding:8px 10px;text-align:center">Score</th>
          </tr>
        </thead>
        <tbody>${riskRankRows}</tbody>
      </table>
    </div>

    <!-- Common vuln categories -->
    <div class="sec-hdr"><span class="sec-title">ğŸ” Common Vulnerability Categories</span></div>
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:var(--r);
                padding:12px;margin-bottom:14px">
      ${catRows || '<div style="font-size:12px;color:var(--muted)">No common patterns found</div>'}
    </div>

    <!-- Per-contract cards -->
    <div class="sec-hdr"><span class="sec-title">ğŸ“„ Individual Reports</span></div>
    ${contractCards}

    <div style="text-align:center;margin:16px 0 4px;font-size:10px;color:var(--dim)">
      TonAudit AI Batch Report Â· ${auditTime}
    </div>`;

  el.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function showSingleFromBatch(idx) {
  if (!lastBatchReport || !lastBatchReport.reports[idx]) return;
  lastReport = lastBatchReport.reports[idx];
  renderReport(lastBatchReport.reports[idx]);
}

/* â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
loadSamples();
setTab('paste');
</script>
</body>
</html>
